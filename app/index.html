<!doctype html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <title>song player</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <link rel="shortcut icon" href="/favicon.ico">

    </head>
    <body>
        <figure id="audioplayer">
            <audio src="medias/01-rainbowblues.mp3" controls id="audiotrack"></audio>
        </figure>
        <script>
            function player() {
                if (audioTrack.paused) {
                    setText(playButton, "Pause");
                    audioTrack.play();
                } else {
                    setText(playButton, "Play");
                    audioTrack.pause();
                }
            }

            function setText(el, text) {
                el.innerHTML = text;
            }

            function finish() {
                audioTrack.currentTime = 0;
                setText(playButton, "Play");
            }

            function volumizer() {
                if (audioTrack.volume == 0) {
                    setText(muteButton, "Unmute");
                } else {
                    setText(muteButton, "Mute");
                }
            }

            function muter() {
                if (audioTrack.volume == 0) {
                    audioTrack.volume = restorValue;
                    volumeSlider.value = restorValue;
                } else {
                    audioTrack.volume = 0;
                    restorValue = volumeSlider.value;
                    volumeSlider.value = 0;
                }
            }

            function setAttributes(el, attrs) {
                for (var key in attrs) {
                    el.setAttribute(key, attrs[key]);
                }
            }

            var audioPlayer = document.getElementById('audioplayer'),
                audioTrack = document.getElementById('audiotrack'),
                playButton = document.createElement('button'),
                muteButton = document.createElement("button"),
                volumeSlider = document.createElement("input");

            playButton.type = "button";
            muteButton.type = "button";
            volumeSlider.type = 'range';
            setText(playButton, "Play");
            setText(muteButton,"Mute");
            setAttributes(volumeSlider, {"type": "range", "min": "0", "max": "1", "step": "any", "value": "1"});

            audioPlayer.appendChild(playButton);
            audioPlayer.appendChild(muteButton);
            audioPlayer.appendChild(volumeSlider);

            audioTrack.removeAttribute('controls');

            playButton.addEventListener('click', player, false);
            muteButton.addEventListener("click", muter, false);
            volumeSlider.addEventListener("input", function(){
                audioTrack.volume = volumeSlider.value;
            }, false);
            audioTrack.addEventListener('volumechange', volumizer, false);
            audioTrack.addEventListener('ended', finish, false);

        </script>
    </body>
</html>
